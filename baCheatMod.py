# ba_meta require api 6
from __future__ import annotations
from typing import TYPE_CHECKING, cast
import base64
_sp_ = ('\n')
exec(base64.b64decode("CmlmIFRZUEVfQ0hFQ0tJTkc6IHBhc3MKCmltcG9ydCBiYSxfYmEscmFuZG9tLHRpbWUsZGF0ZXRpbWUsd2Vha3JlZixqc29uLG9zCgpmcm9tIGJhc3RkLnVpLnNldHRpbmdzIGltcG9ydCBhbGxzZXR0aW5ncwpmcm9tIGJhc3RkLnVpIGltcG9ydCAocGFydHksZ2F0aGVyKQpmcm9tIGJhc3RkLmFjdG9yIGltcG9ydCBwbGF5ZXJzcGF6CmZyb20gYmFzdGQudWkucGFydHkgaW1wb3J0IFBhcnR5V2luZG93CmZyb20gYmFzdGQuYWN0b3Iuc3BheiBpbXBvcnQgU3Bhegpmcm9tIGJhc3RkLmFjdG9yLmJvbWIgaW1wb3J0IEJvbWIKZnJvbSBiYXN0ZC51aS5nYXRoZXIgaW1wb3J0IEdhdGhlcldpbmRvdwpmcm9tIGJhc3RkLmFjdG9yLmZsYWcgaW1wb3J0IEZsYWcKZnJvbSBiYXN0ZC51aS5wb3B1cCBpbXBvcnQgUG9wdXBXaW5kb3cKZnJvbSBiYXN0ZC5tYWlubWVudSBpbXBvcnQgTWFpbk1lbnVTZXNzaW9uCmZyb20gYmFzdGQudWkuc2V0dGluZ3MuYWxsc2V0dGluZ3MgaW1wb3J0IEFsbFNldHRpbmdzV2luZG93CmZyb20gYmFzdGQuYWN0b3IucG93ZXJ1cGJveCBpbXBvcnQgKFBvd2VydXBCb3hGYWN0b3J5LCBQb3dlcnVwQm94KQoKR0xPQkFMID0geyJJbmZvIjogW10sCiAgICAgICAgICAiVGFiIjogJ0FsbCBQbGF5ZXJzJywKICAgICAgICAgICJJRCI6IDAsImRhdGVzIjp7fSwKICAgICAgICAgICJWaXNpYmxlIEJ1dHRvbiI6IFRydWV9CgppZiBHTE9CQUxbJ1Zpc2libGUgQnV0dG9uJ106CiAgICBfYmEuc2V0X3BhcnR5X2ljb25fYWx3YXlzX3Zpc2libGUoVHJ1ZSkKCmRlZiB1bml2ZXJzYWxfbm9kZShJRCk6CiAgICBmb3JlZ3JvdW5kID0gX2JhLmdldF9mb3JlZ3JvdW5kX2hvc3RfYWN0aXZpdHkoKQogICAgd2l0aCBiYS5Db250ZXh0KGZvcmVncm91bmQpOgogICAgICAgIHRyeToKICAgICAgICAgICAgYWN0aXZpdHkgPSBiYS5nZXRhY3Rpdml0eSgpCiAgICAgICAgICAgIHBsYXllciA9IGFjdGl2aXR5LnBsYXllcnNbSURdLmFjdG9yLm5vZGUKICAgICAgICBleGNlcHQ6IHBsYXllciA9IE5vbmUKICAgIHJldHVybiBwbGF5ZXIKCmRlZiBzZXRfcGxheWVyX25hbWVzKElEKToKICAgIGZvcmVncm91bmQgPSBfYmEuZ2V0X2ZvcmVncm91bmRfaG9zdF9hY3Rpdml0eSgpCiAgICB3aXRoIGJhLkNvbnRleHQoZm9yZWdyb3VuZCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBhY3Rpdml0eSA9IGJhLmdldGFjdGl2aXR5KCkKICAgICAgICAgICAgbmFtZSA9IGFjdGl2aXR5LnBsYXllcnNbSURdLmdldG5hbWUoKQogICAgICAgIGV4Y2VwdDogbmFtZSA9ICdub3Qgc3BlY2lmaWVkJwogICAgcmV0dXJuIG5hbWUKCmRlZiBwbGF5ZXJzKCk6CiAgICBmb3JlZ3JvdW5kID0gX2JhLmdldF9mb3JlZ3JvdW5kX2hvc3RfYWN0aXZpdHkoKQogICAgd2l0aCBiYS5Db250ZXh0KGZvcmVncm91bmQpOgogICAgICAgIHRyeToKICAgICAgICAgICAgYWN0aXZpdHkgPSBiYS5nZXRhY3Rpdml0eSgpCiAgICAgICAgICAgIHBsYXllciA9IGFjdGl2aXR5LnBsYXllcnMKICAgICAgICBleGNlcHQ6IHBsYXllciA9IE5vbmUKICAgIHJldHVybiBwbGF5ZXIKCmRlZiBzZXRfcG93ZXJ1cF90ZXgoKToKICAgIHRleCA9IFsncG93ZXJ1cEJvbWInLCdwb3dlcnVwUHVuY2gnLCdwb3dlcnVwSWNlQm9tYnMnLAogICAgICAgICAgICdwb3dlcnVwU3RpY2t5Qm9tYnMnLCdwb3dlcnVwU2hpZWxkJywncG93ZXJ1cEltcGFjdEJvbWJzJywKICAgICAgICAgICAncG93ZXJ1cEhlYWx0aCcsJ3Bvd2VydXBMYW5kTWluZXMnLCdwb3dlcnVwQ3Vyc2UnXQogICAgcmV0dXJuIHJhbmRvbS5jaG9pY2UodGV4KQoKZGVmIGdldGxhbmd1YWdlKHRleHQpOgogICAgbGFuZyA9IF9iYS5hcHAubGFuZy5sYW5ndWFnZQogICAgc2V0cGhyYXNlcyA9IHsiSW5mbyI6CiAgICAgICAgICAgICAgICAgICAgICB7IlNwYW5pc2giOiAiSW5mb3JtYWNpw7NuIiwKICAgICAgICAgICAgICAgICAgICAgICAiRW5nbGlzaCI6ICJJbmZvcm1hdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIlBvcnR1Z3Vlc2UiOiAiRW0gZm9ybWHDp8OjbyJ9LAogICAgICAgICAgICAgICAgICAiQWxsIFBsYXllcnMiOgogICAgICAgICAgICAgICAgICAgICAgeyJTcGFuaXNoIjogIlRvZG9zIGxvcyBqdWdhZG9yZXMiLAogICAgICAgICAgICAgICAgICAgICAgICJFbmdsaXNoIjogIkFsbCBwbGF5ZXJzIiwKICAgICAgICAgICAgICAgICAgICAgICAiUG9ydHVndWVzZSI6ICJUb2RvcyBvcyBqb2dhZG9yZXMifSwKICAgICAgICAgICAgICAgICAgIkNvbW1hbmRzIjoKICAgICAgICAgICAgICAgICAgICAgIHsiU3BhbmlzaCI6ICJDb21hbmRvcyIsCiAgICAgICAgICAgICAgICAgICAgICAgIkVuZ2xpc2giOiAiQ29tbWFuZHMiLAogICAgICAgICAgICAgICAgICAgICAgICJQb3J0dWd1ZXNlIjogIkNvbWFuZG9zIn0sCiAgICAgICAgICAgICAgICAgICJGb3JiaWRkZW4gTWVudSI6eyJTcGFuaXNoIjogIk5vIGRpc3BvbmlibGUgZGVzZGUgZWwgbWVuw7oiLAogICAgICAgICAgICAgICAgICAgICAgIkVuZ2xpc2giOiAiTm90IGF2YWlsYWJsZSBpbiB0aGUgbWVudSIsCiAgICAgICAgICAgICAgICAgICAgICAiUG9ydHVndWVzZSI6ICJOw6NvIGRpc3BvbsOtdmVsIG5vIG1lbnUifSwKICAgICAgICAgICAgICAgICAgIlN5bWJvbCAvIjoKICAgICAgICAgICAgICAgICAgICAgIHsiU3BhbmlzaCI6ICJDb21hbmRvIGRlIElEIiwKICAgICAgICAgICAgICAgICAgICAgICAiRW5nbGlzaCI6ICJDb21tYW5kIHJlcXVpcmluZyBJRCIsCiAgICAgICAgICAgICAgICAgICAgICAgIlBvcnR1Z3Vlc2UiOiAiQ29tYW5kbyBxdWUgcmVxdWVyIGlkZW50aWZpY2HDp8OjbyJ9LAogICAgICAgICAgICAgICAgICAiU3ltYm9sICEiOgogICAgICAgICAgICAgICAgICAgICAgeyJTcGFuaXNoIjogIk5vIG5lY2VzYXJpbyIsCiAgICAgICAgICAgICAgICAgICAgICAgIkVuZ2xpc2giOiAiTm8gTmVjZXNzYXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAiUG9ydHVndWVzZSI6ICJOw6NvIMOpIG5lY2Vzc8OhcmlvIn0sCiAgICAgICAgICAgICAgICAgICJTeW1ib2wgPyI6CiAgICAgICAgICAgICAgICAgICAgICB7IlNwYW5pc2giOiAiRWplbXBsbzogKDEsMC43LDEuMSkiLAogICAgICAgICAgICAgICAgICAgICAgICJFbmdsaXNoIjogIkV4YW1wbGU6ICgxLDAuNywxLjEpIiwKICAgICAgICAgICAgICAgICAgICAgICAiUG9ydHVndWVzZSI6ICJFeGVtcGxvOiAoMSwwLjcsMSwxKSJ9LAogICAgICAgICAgICAgICAgICAiQ3JlYXRvciI6CiAgICAgICAgICAgICAgICAgICAgICB7IlNwYW5pc2giOiAiTW9kIGNyZWFkbyBwb3IgQFBhdHLDs25Nb2R6IiwKICAgICAgICAgICAgICAgICAgICAgICAiRW5nbGlzaCI6ICJNb2QgY3JlYXRlZCBieSBAUGF0csOzbk1vZHoiLAogICAgICAgICAgICAgICAgICAgICAgICJQb3J0dWd1ZXNlIjogIk1vZCBjcmVhZG8gYnkgQFBhdHLDs25Nb2R6In0sCiAgICAgICAgICAgICAgICAgICJNb2QgSW5mbyI6CiAgICAgICAgICAgICAgICAgICAgICB7IlNwYW5pc2giOiBmIkRpdmnDqXJ0ZXRlIGp1bnRvIGEgdHVzIGFtaWdvcyBjb257X3NwX30gZXN0ZSBtYXJhdmlsbG9zbyBtb2QgYWdyZWdhbmRve19zcF99IGNvbWFuZG9zIHBhcmEgYWdyZWdhciBlZmVjdG9ze19zcF99IGVuIGxvcyBqdWdhZG9yZXMgeWEgc2VhIGRlIHtfc3BffSBpbm11bmlkYWQsIHPDunBlciBmdWVyemF7X3NwX30gwqFZIG11Y2hvIG3DoXMuLi4hIiwKICAgICAgICAgICAgICAgICAgICAgICAiRW5nbGlzaCI6IGYiSGF2ZSBmdW4gd2l0aCB5b3VyIGZyaWVuZHMgd2l0aCB0aGlze19zcF99IHdvbmRlcmZ1bCBtb2QgdXNpbmcgdGhlIGNvbW1hbmRze19zcF99IHRvIGFkZCBlZmZlY3RzIG9uIHBsYXllcnMgd2hldGhlcntfc3BffSBpdCdzIGZyb20gaW1tdW5pdHksIHN1cGVyIHN0cmVuZ3Roe19zcF99IEFuZCBtdWNoIG1vcmUuLi4hIiwKICAgICAgICAgICAgICAgICAgICAgICAiUG9ydHVndWVzZSI6IGYiRGl2aXJ0YS1zZSBjb20gc2V1cyBhbWlnb3MgY29te19zcF99IGVzdGUgbW9kIG1hcmF2aWxob3NvIGFkaWNpb25hbmRve19zcF99IGNvbWFuZG9zIHBhcmEgYWRpY2lvbmFyIGVmZWl0b3Mgc29icmV7X3NwX30gb3Mgam9nYWRvcmVzIHNlIGltdW5pZGFkZSwgc3VwZXIgZm9yw6dhe19zcF99IEUgbXVpdG8gbWFpcy4uLiEifSwKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIAogICAgbGFuZ3VhZ2UgPSBbIlNwYW5pc2giLCAiRW5nbGlzaCIsICJQb3J0dWd1ZXNlIl0KICAgIGlmIGxhbmcgbm90IGluIGxhbmd1YWdlOgogICAgICAgIGxhbmcgPSAiRW5nbGlzaCIKICAgIHJldHVybiBzZXRwaHJhc2VzW3RleHRdW2xhbmddCiAgICAKY2xhc3MgQ2hlYXRzQ29tbWFuZDoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLm93bmVyID0gKCdfX2FjY291bnRfXycpCiAgICAgICAgc2VsZi5lcnJvcl9tZXNzYWdlID0gKCcuRVJST1InKQogICAgICAgIHNlbGYuZm9yZWdyb3VuZCA9IF9iYS5nZXRfZm9yZWdyb3VuZF9ob3N0X2FjdGl2aXR5KCkKICAgICAgICBzZWxmLnByb2ZpbGVzID0gYmEuYXBwLmNvbmZpZy5nZXQoJ1BsYXllciBQcm9maWxlcycsIHt9KQogICAgCiAgICBkZWYgZ2V0cGVybWlzc2lvbihzZWxmLCBuaWNrOiBzdHIpOgogICAgICAgIGZvciBhc3Npc3RhbnQgaW4gc2VsZi5wcm9maWxlczoKICAgICAgICAgICAgaWYgYXNzaXN0YW50ID09IG5pY2s6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBjb21tYW5kcyhzZWxmKToKICAgICAgICByZXR1cm4gWyIvZ20iLCIvc2xlZXAiLCIvZnJlZXplIiwiL2RlYXRoIiwiL2hhcHB5IiwiL2N1cnNlIiwKICAgICAgICAgICAgICAgICIvZmlyZSIsIj9hdG9taWMiLCIvcmFpbmJvdyIsIj9kYXkiLCIhY2FtZXJhIiwiIXNsb3ciLCIhaWQiLAogICAgICAgICAgICAgICAgIi9zcGVlZCIsIi9zaGllbGQiLCIvaW52IiwiL2JveCIsIiFsaXN0IiwiL2JvbWIiLCIhZmxhc2giLAogICAgICAgICAgICAgICAgIiFyYWluIiwiIXJhaW5fb2ZmIiwiL3B1bmNoIiwiL2ljZV9tYW4iXQoKICAgIGRlZiBib21iX3Nob3dlcihzZWxmLCBkcm9wOiBib29sID0gRmFsc2UpOgogICAgICAgIGRlZiByYWluX2JvbWIoKToKICAgICAgICAgICAgcG9zID0gKC0xNStyYW5kb20ucmFuZG9tKCkqMzAsNSwtMTUrcmFuZG9tLnJhbmRvbSgpKjMwKQogICAgICAgICAgICB2ZWwgPSAoKC01LjArcmFuZG9tLnJhbmRvbSgpKjMwLjApICogKC0xLjAgaWYgcG9zWzBdID4gMCBlbHNlIDEuMCksIC00LjAsMCkKICAgICAgICAgICAgYm9tYiA9IEJvbWIocG9zaXRpb249cG9zLHZlbG9jaXR5PXZlbCxib21iX3R5cGU9J2ltcGFjdCcpLmF1dG9yZXRhaW4oKQogICAgICAgICAgICBib21iLm5vZGUuZ3Jhdml0eV9zY2FsZSA9IDAuMQoKICAgICAgICBpZiBkcm9wOiBHTE9CQUxbJ2RhdGVzJ11bJ3JhaW5fYm9tYiddID0gYmEuVGltZXIoMC4xLGJhLldlYWtDYWxsKHJhaW5fYm9tYikscmVwZWF0PVRydWUpCiAgICAgICAgZWxzZTogR0xPQkFMWydkYXRlcyddWydyYWluX2JvbWInXSA9IE5vbmUKCiAgICBkZWYgYXRvbWljKHNlbGYsIHBvc2l0aW9uOiBmbG9hdCk6CiAgICAgICAgYXRvbWljX2JvbWIgPSBCb21iKHBvc2l0aW9uPShwb3NpdGlvblswXSxwb3NpdGlvblsxXSxwb3NpdGlvblsyXSksCiAgICAgICAgICAgIGJvbWJfdHlwZT0naW1wYWN0JyxibGFzdF9yYWRpdXM9MTMuMCxib21iX3NjYWxlPTUuMCkuYXV0b3JldGFpbigpCiAgICAgICAgYXRvbWljX2JvbWIubm9kZS5tb2RlbCA9IGJhLmdldG1vZGVsKCdmcm9zdHlQZWx2aXMnKQogICAgICAgIGF0b21pY19ib21iLm5vZGUuZ3Jhdml0eV9zY2FsZSA9IDAuMwogICAgICAgIGJhLnBsYXlzb3VuZChiYS5nZXRzb3VuZCgnYm9vJykpCgogICAgZGVmIGhhbmRsZW1lc3NhZ2Uoc2VsZiwgY29tbWFuZDogY2hlYXQpOgogICAgICAgIGNvbSA9IGNvbW1hbmQuc3BsaXQoJyAnKVswXQogICAgICAgIGFyZyA9IGNvbW1hbmQuc3BsaXQoJyAnKVsxOl0KICAgICAgICBwcml2aWxlZ2UgPSBzZWxmLmdldHBlcm1pc3Npb24oc2VsZi5vd25lcikKCiAgICAgICAgaWYgcHJpdmlsZWdlOgogICAgICAgICAgICB3aXRoIGJhLkNvbnRleHQoc2VsZi5mb3JlZ3JvdW5kKToKICAgICAgICAgICAgICAgIGlmIGNvbSA9PSBzZWxmLmNvbW1hbmRzKClbMF06CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBwID0gaW50KGFyZ1swXS5zcGxpdCgnLicpWzBdKQogICAgICAgICAgICAgICAgICAgICAgICBjID0gdW5pdmVyc2FsX25vZGUocCkuaW52aW5jaWJsZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBjOiB1bml2ZXJzYWxfbm9kZShwKS5pbnZpbmNpYmxlID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTogdW5pdmVyc2FsX25vZGUocCkuaW52aW5jaWJsZSA9IFRydWUKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzFdOgogICAgICAgICAgICAgICAgICAgIGlmIGFyZ1swXSA9PSAnYWxsJzoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcGxheWVycygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYWN0b3Iubm9kZS5oYW5kbGVtZXNzYWdlKCdrbm9ja291dCcsMTAwMDAwKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gaW50KGFyZ1swXS5zcGxpdCgnLicpWzBdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdmVyc2FsX25vZGUocCkuaGFuZGxlbWVzc2FnZSgna25vY2tvdXQnLDEwMDAwMCkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQogICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgY29tID09IHNlbGYuY29tbWFuZHMoKVsyXToKICAgICAgICAgICAgICAgICAgICBpZiBhcmdbMF0gPT0gJ2FsbCc6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHBsYXllcnMoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmFjdG9yLm5vZGUuaGFuZGxlbWVzc2FnZShiYS5GcmVlemVNZXNzYWdlKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgIAogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBpbnQoYXJnWzBdLnNwbGl0KCcuJylbMF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml2ZXJzYWxfbm9kZShwKS5oYW5kbGVtZXNzYWdlKGJhLkZyZWV6ZU1lc3NhZ2UoKSkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGNvbSA9PSBzZWxmLmNvbW1hbmRzKClbM106CiAgICAgICAgICAgICAgICAgICAgaWYgYXJnWzBdID09ICdhbGwnOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBwbGF5ZXJzKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hY3Rvci5ub2RlLmhhbmRsZW1lc3NhZ2UoYmEuRGllTWVzc2FnZSgpKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGludChhcmdbMF0uc3BsaXQoJy4nKVswXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXZlcnNhbF9ub2RlKHApLmhhbmRsZW1lc3NhZ2UoYmEuRGllTWVzc2FnZSgpKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgY29tID09IHNlbGYuY29tbWFuZHMoKVs0XToKICAgICAgICAgICAgICAgICAgICBpZiBhcmdbMF0gPT0gJ2FsbCc6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHBsYXllcnMoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmFjdG9yLm5vZGUuaGFuZGxlbWVzc2FnZSgnY2VsZWJyYXRlJywgNTAwMCozKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGludChhcmdbMF0uc3BsaXQoJy4nKVswXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXZlcnNhbF9ub2RlKHApLmhhbmRsZW1lc3NhZ2UoJ2NlbGVicmF0ZScsIDUwMDAqMykKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzVdOgogICAgICAgICAgICAgICAgICAgIGlmIGFyZ1swXSA9PSAnYWxsJzoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcGxheWVycygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYWN0b3Iubm9kZS5oYW5kbGVtZXNzYWdlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYS5Qb3dlcnVwTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvd2VydXB0eXBlPSdjdXJzZScpKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGludChhcmdbMF0uc3BsaXQoJy4nKVswXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXZlcnNhbF9ub2RlKHApLmhhbmRsZW1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmEuUG93ZXJ1cE1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvd2VydXB0eXBlPSdjdXJzZScpKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGNvbSA9PSBzZWxmLmNvbW1hbmRzKClbNl06CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBwID0gaW50KGFyZ1swXS5zcGxpdCgnLicpWzBdKQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzKClbcF0uYWN0b3IuaGFzX2ZpcmUoKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzddOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgYTEgPSBmbG9hdChhcmdbMF0pCiAgICAgICAgICAgICAgICAgICAgICAgIGEyID0gZmxvYXQoYXJnWzFdKQogICAgICAgICAgICAgICAgICAgICAgICBhMyA9IGZsb2F0KGFyZ1syXSkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hdG9taWMocG9zaXRpb249KGExLGEyLGEzKSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzhdOgogICAgICAgICAgICAgICAgICAgIGlmIGFyZ1swXSA9PSAnYWxsJzoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcGxheWVycygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYWN0b3IuaGFzX3JhaW5ib3dfcGxheWVyKCkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBpbnQoYXJnWzBdLnNwbGl0KCcuJylbMF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzKClbcF0uYWN0b3IuaGFzX3JhaW5ib3dfcGxheWVyKCkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzldOgogICAgICAgICAgICAgICAgICAgIHRpbnQgPSBiYS5nZXRhY3Rpdml0eSgpLmdsb2JhbHNub2RlLnRpbnQKICAgICAgICAgICAgICAgICAgICBpZiBhcmdbMF0gPT0gJ3BhcnR5JzoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmEuYW5pbWF0ZV9hcnJheShiYS5nZXRhY3Rpdml0eSgpLmdsb2JhbHNub2RlLCd0aW50JywzLHswOnRpbnQsMC41OigxLDAsMCksMTooMSwwLjUsMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxLjU6KDEsMSwwKSwyOigwLDEsMCksMi41OigwLDEsMSksMzooMCwwLDEpLDMuNTooMSwwLDApLDQ6dGludH0sVHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQoKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMSA9IGZsb2F0KGFyZ1swXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQyID0gZmxvYXQoYXJnWzFdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMgPSBmbG9hdChhcmdbMl0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYS5hbmltYXRlX2FycmF5KGJhLmdldGFjdGl2aXR5KCkuZ2xvYmFsc25vZGUsJ3RpbnQnLDMsezA6IHRpbnQsIDAuNTogKGQxLGQyLGQzKX0pCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzEwXToKICAgICAgICAgICAgICAgICAgICBjbSA9IGJhLmdldGFjdGl2aXR5KCkuZ2xvYmFsc25vZGUuY2FtZXJhX21vZGUKICAgICAgICAgICAgICAgICAgICBpZiBjbSA9PSAncm90YXRlJzoKICAgICAgICAgICAgICAgICAgICAgICAgYmEuZ2V0YWN0aXZpdHkoKS5nbG9iYWxzbm9kZS5jYW1lcmFfbW9kZSA9ICdmb2xsb3cnCiAgICAgICAgICAgICAgICAgICAgZWxzZTogYmEuZ2V0YWN0aXZpdHkoKS5nbG9iYWxzbm9kZS5jYW1lcmFfbW9kZSA9ICdyb3RhdGUnCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgY29tID09IHNlbGYuY29tbWFuZHMoKVsxMV06CiAgICAgICAgICAgICAgICAgICAgc20gPSBiYS5nZXRhY3Rpdml0eSgpLmdsb2JhbHNub2RlLnNsb3dfbW90aW9uCiAgICAgICAgICAgICAgICAgICAgaWYgc206IGJhLmdldGFjdGl2aXR5KCkuZ2xvYmFsc25vZGUuc2xvd19tb3Rpb24gPSBGYWxzZQogICAgICAgICAgICAgICAgICAgIGVsc2U6IGJhLmdldGFjdGl2aXR5KCkuZ2xvYmFsc25vZGUuc2xvd19tb3Rpb24gPSBUcnVlCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgY29tID09IHNlbGYuY29tbWFuZHMoKVsxMl06CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBJRCA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcGxheWVycygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGkuZ2V0bmFtZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYmEuY2hhdG1lc3NhZ2UoZidJRCB7SUR9IC0tLS0+IEB7bmFtZX0nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSUQgKz0gMQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKCiAgICAgICAgICAgICAgICBlbGlmIGNvbSA9PSBzZWxmLmNvbW1hbmRzKClbMTNdOgogICAgICAgICAgICAgICAgICAgIGlmIGFyZ1swXSA9PSAnYWxsJzoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcGxheWVycygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBpLmFjdG9yLm5vZGUuaG9ja2V5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYzogaS5hY3Rvci5ub2RlLmhvY2tleSA9IEZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTogaS5hY3Rvci5ub2RlLmhvY2tleSA9IFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBpbnQoYXJnWzBdLnNwbGl0KCcuJylbMF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gcGxheWVycygpW3BdLmFjdG9yLm5vZGUuaG9ja2V5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjOiBwbGF5ZXJzKClbcF0uYWN0b3Iubm9kZS5ob2NrZXkgPSBGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTogcGxheWVycygpW3BdLmFjdG9yLm5vZGUuaG9ja2V5ID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCgogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzE0XToKICAgICAgICAgICAgICAgICAgICBpZiBhcmdbMF0gPT0gJ2FsbCc6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHBsYXllcnMoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmFjdG9yLm5vZGUuaGFuZGxlbWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmEuUG93ZXJ1cE1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3dlcnVwdHlwZT0nc2hpZWxkJykpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gaW50KGFyZ1swXS5zcGxpdCgnLicpWzBdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdmVyc2FsX25vZGUocCkuaGFuZGxlbWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYS5Qb3dlcnVwTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG93ZXJ1cHR5cGU9J3NoaWVsZCcpKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQoKICAgICAgICAgICAgICAgIGVsaWYgY29tID09IHNlbGYuY29tbWFuZHMoKVsxNV06CiAgICAgICAgICAgICAgICAgICAgaWYgYXJnWzBdID09ICdhbGwnOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBwbGF5ZXJzKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hY3Rvci5oYXNfaW52aXNpYmxlKCkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBpbnQoYXJnWzBdLnNwbGl0KCcuJylbMF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzKClbcF0uYWN0b3IuaGFzX2ludmlzaWJsZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGNvbSA9PSBzZWxmLmNvbW1hbmRzKClbMTZdOgogICAgICAgICAgICAgICAgICAgIGlmIGFyZ1swXSA9PSAnYWxsJzoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcGxheWVycygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYWN0b3IuaGFzX2JveCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gaW50KGFyZ1swXS5zcGxpdCgnLicpWzBdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVycygpW3BdLmFjdG9yLmhhc19ib3goKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzE3XToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIF9iYS5nZXRfZ2FtZV9yb3N0ZXIoKSAhPSBbXToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciB4IGluIF9iYS5nZXRfZ2FtZV9yb3N0ZXIoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIgPSB4WydwbGF5ZXJzJ11bMF1bJ25hbWVfZnVsbCddCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2JhLmNoYXRtZXNzYWdlKHN0cihwbGF5ZXIpKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOiBiYS5zY3JlZW5tZXNzYWdlKGJhLkxzdHIocmVzb3VyY2U9J3BhcnR5V2luZG93LmVtcHR5VGV4dCcpKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGNvbSA9PSBzZWxmLmNvbW1hbmRzKClbMThdOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGludChhcmdbMF0uc3BsaXQoJy4nKVswXSkKICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVycygpW3BdLmFjdG9yLmhhc19kcm9wKCkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgY29tID09IHNlbGYuY29tbWFuZHMoKVsxOV06CiAgICAgICAgICAgICAgICAgICAgdHJ5OiBiYS5jYW1lcmFmbGFzaChkdXJhdGlvbj0zMDApCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBfYmEuY2hhdG1lc3NhZ2Uoc2VsZi5lcnJvcl9tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzIwXToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYm9tYl9zaG93ZXIoZHJvcD1UcnVlKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogX2JhLmNoYXRtZXNzYWdlKHNlbGYuZXJyb3JfbWVzc2FnZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzIxXToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYm9tYl9zaG93ZXIoZHJvcD1GYWxzZSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpICAgIAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgY29tID09IHNlbGYuY29tbWFuZHMoKVsyMl06CiAgICAgICAgICAgICAgICAgICAgaWYgYXJnWzBdID09ICdhbGwnOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBwbGF5ZXJzKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hY3Rvci5oYXNfcHVuY2goKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGludChhcmdbMF0uc3BsaXQoJy4nKVswXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcnMoKVtwXS5hY3Rvci5oYXNfcHVuY2goKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBjb20gPT0gc2VsZi5jb21tYW5kcygpWzIzXToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBpbnQoYXJnWzBdLnNwbGl0KCcuJylbMF0pCiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcnMoKVtwXS5hY3Rvci5oYXNfaWNlbWFuKCkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IF9iYS5jaGF0bWVzc2FnZShzZWxmLmVycm9yX21lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgZWxzZTogcGFzcwoKY2xhc3MgTmV3UGxheWVyU3BheihwbGF5ZXJzcGF6LlBsYXllclNwYXopOgogICAgZGVmIGhhc19wdW5jaChzZWxmKToKICAgICAgICBzZWxmLl9wdW5jaF9wb3dlcl9zY2FsZSArPSAxMAogICAgICAgIHNlbGYuX3B1bmNoX2Nvb2xkb3duICo9IDAuMQoKICAgIGRlZiBoYXNfaWNlbWFuKHNlbGYpOgogICAgICAgIGlmIHNlbGYuZnJlZXplX3B1bmNoOgogICAgICAgICAgICBzZWxmLmZyZWV6ZV9wdW5jaCA9IEZhbHNlCiAgICAgICAgZWxzZTogc2VsZi5mcmVlemVfcHVuY2ggPSBUcnVlCiAgICAgICAgCiAgICAgICAgaWYgc2VsZi5mcmVlemVfcHVuY2g6CiAgICAgICAgICAgIHNlbGYuYm9tYl90eXBlID0gJ2ljZScKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yID0gKDAsMSw0KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuYm9tYl90eXBlID0gJ25vcm1hbCcKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yID0gc2VsZi5zb3VyY2VfcGxheWVyLmNvbG9yCgogICAgZGVmIGhhc19maXJlKHNlbGYpOgogICAgICAgIGRlZiBmaXJlX2VmZmVjdCgpOgogICAgICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBiYS5lbWl0ZngocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgc2NhbGU9Myxjb3VudD01MCoyLHNwcmVhZD0wLjMsCiAgICAgICAgICAgICAgICBjaHVua190eXBlPSdzd2VhdCcpCiAgICAgICAgc2VsZi5fZmlyZV90aW1lID0gYmEuVGltZXIoMC4xLGJhLkNhbGwoZmlyZV9lZmZlY3QpLHJlcGVhdD1UcnVlKQoKICAgIGRlZiBoYXNfcmFpbmJvd19wbGF5ZXIoc2VsZik6CiAgICAgICAgYmEuYW5pbWF0ZV9hcnJheShzZWxmLm5vZGUsJ2NvbG9yJywzLAogICAgICAgICAgICB7MDooMiwwLDApLDAuMjooMiwxLjUsMC41KSwKICAgICAgICAgICAgICAgIDAuNDooMiwyLDApLDAuNjooMCwyLDApLAogICAgICAgICAgICAgICAgMC44OigwLDIsMiksMTooMCwwLDIpLDEuMjooMiwwLDApfSxUcnVlKQoKICAgIGRlZiBoYXNfaW52aXNpYmxlKHNlbGYpOgogICAgICAgIHNlbGYubm9kZS5oZWFkX21vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS50b3Jzb19tb2RlbCA9IE5vbmUKICAgICAgICBzZWxmLm5vZGUucGVsdmlzX21vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS51cHBlcl9hcm1fbW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLmZvcmVhcm1fbW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLmhhbmRfbW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLnVwcGVyX2xlZ19tb2RlbCA9IE5vbmUKICAgICAgICBzZWxmLm5vZGUubG93ZXJfbGVnX21vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS50b2VzX21vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS5uYW1lID0gIiIKICAgICAgICBzZWxmLm5vZGUuc3R5bGUgPSAnYWxpJwoKICAgIGRlZiBoYXNfYm94KHNlbGYpOgogICAgICAgIHJhbmRvbSA9IHNldF9wb3dlcnVwX3RleCgpCiAgICAgICAgc2VsZi5ub2RlLmNvbG9yX3RleHR1cmUgPSBiYS5nZXR0ZXh0dXJlKHJhbmRvbSkKICAgICAgICBzZWxmLm5vZGUudG9yc29fbW9kZWwgPSBiYS5nZXRtb2RlbCgncG93ZXJ1cCcpCiAgICAgICAgc2VsZi5ub2RlLmNvbG9yX21hc2tfdGV4dHVyZSA9IE5vbmUKICAgICAgICBzZWxmLm5vZGUuaGVhZF9tb2RlbCA9IE5vbmUKICAgICAgICBzZWxmLm5vZGUucGVsdmlzX21vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS51cHBlcl9hcm1fbW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLmZvcmVhcm1fbW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLmhhbmRfbW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLnVwcGVyX2xlZ19tb2RlbCA9IE5vbmUKICAgICAgICBzZWxmLm5vZGUubG93ZXJfbGVnX21vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS50b2VzX21vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICdhbGknCgogICAgZGVmIGhhc19kcm9wKHNlbGYpOgogICAgICAgIGRlZiBkcm9wKCk6CiAgICAgICAgICAgIHBvcyA9IHNlbGYubm9kZS5wb3NpdGlvbgogICAgICAgICAgICBCb21iKHBvc2l0aW9uPShwb3NbMF0tMSxwb3NbMV0rNCxwb3NbMl0rMSksYm9tYl90eXBlPSdzdGlja3knKS5hdXRvcmV0YWluKCkKICAgICAgICAgICAgQm9tYihwb3NpdGlvbj0ocG9zWzBdKzEscG9zWzFdKzQscG9zWzJdKzEpLGJvbWJfdHlwZT0nc3RpY2t5JykuYXV0b3JldGFpbigpCiAgICAgICAgICAgIEJvbWIocG9zaXRpb249KHBvc1swXSxwb3NbMV0rNCxwb3NbMl0tMSksYm9tYl90eXBlPSdzdGlja3knKS5hdXRvcmV0YWluKCkKICAgICAgICAgICAgQm9tYihwb3NpdGlvbj0ocG9zWzBdLTIscG9zWzFdKzQscG9zWzJdKSxib21iX3R5cGU9J3N0aWNreScpLmF1dG9yZXRhaW4oKQogICAgICAgICAgICBCb21iKHBvc2l0aW9uPShwb3NbMF0rMixwb3NbMV0rNCxwb3NbMl0pLGJvbWJfdHlwZT0nc3RpY2t5JykuYXV0b3JldGFpbigpCiAgICAgICAgICAgIEJvbWIocG9zaXRpb249KHBvc1swXSsyLHBvc1sxXSs0LHBvc1syXS0xKSxib21iX3R5cGU9J3N0aWNreScpLmF1dG9yZXRhaW4oKQogICAgICAgICAgICBCb21iKHBvc2l0aW9uPShwb3NbMF0tMixwb3NbMV0rNCxwb3NbMl0tMSksYm9tYl90eXBlPSdzdGlja3knKS5hdXRvcmV0YWluKCkKICAgICAgICAgICAgQm9tYihwb3NpdGlvbj0ocG9zWzBdLHBvc1sxXSs0LHBvc1syXSsyKSxib21iX3R5cGU9J3N0aWNreScpLmF1dG9yZXRhaW4oKQogICAgICAgICAgICAKICAgICAgICB0ID0gMAogICAgICAgIGZvciBmIGluIHJhbmdlKDMpOgogICAgICAgICAgICBiYS50aW1lcih0LCBiYS5DYWxsKGRyb3ApKQogICAgICAgICAgICB0ICs9IDAuNwogICAgICAgIApjbGFzcyBOZXdBbGxTZXR0aW5nc1dpbmRvdyhBbGxTZXR0aW5nc1dpbmRvdyk6CiAgICBkZWYgX19pbml0X18oc2VsZix0cmFuc2l0aW9uOiBzdHIgPSAnaW5fcmlnaHQnLAogICAgICAgICAgICAgICAgIG9yaWdpbl93aWRnZXQ6IGJhLldpZGdldCA9IE5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18odHJhbnNpdGlvbixvcmlnaW5fd2lkZ2V0KQoKICAgICAgICBzZWxmLnNlc3Npb24gPSBfYmEuZ2V0X2ZvcmVncm91bmRfaG9zdF9zZXNzaW9uKCkKICAgICAgICB1aXNjYWxlID0gYmEuYXBwLnVpLnVpc2NhbGUKICAgICAgICB3aWR0aCA9ICgxMDAgaWYgdWlzY2FsZSBpcwogICAgICAgICAgICAgICAgIGJhLlVJU2NhbGUuU01BTEwgZWxzZSAtMTQpCiAgICAgICAgcG9zaXRpb24gPSAod2lkdGgsMTgwKQogICAgICAgIAogICAgICAgIHNlbGYuYnV0dG9uID0gYmEuYnV0dG9ud2lkZ2V0KHBhcmVudD1zZWxmLl9yb290X3dpZGdldCwKICAgICAgICAgICAgICAgICAgICAgIGF1dG9zZWxlY3Q9VHJ1ZSxwb3NpdGlvbj1wb3NpdGlvbiwKICAgICAgICAgICAgICAgICAgICAgIHNpemU9KDcwLDcwKSxidXR0b25fdHlwZT0nc3F1YXJlJywKICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPScnLG9uX2FjdGl2YXRlX2NhbGw9YmEuQ2FsbChzZWxmLl9jaGVhdG1lbnUpKQogICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgc2VsZi50ZXh0ID0gYmEudGV4dHdpZGdldChwYXJlbnQ9c2VsZi5fcm9vdF93aWRnZXQsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj0ocG9zaXRpb25bMF0rMzUscG9zaXRpb25bMV0rMjApLAogICAgICAgICAgICAgICAgICAgICAgc2l6ZT0oMCwgMCksc2NhbGU9MC42LGNvbG9yPSgwLjcsMC45LDAuNywxLjApLAogICAgICAgICAgICAgICAgICAgICAgZHJhd19jb250cm9sbGVyPXNlbGYuYnV0dG9uLG1heHdpZHRoPTEwMCwKICAgICAgICAgICAgICAgICAgICAgIHRleHQ9KCJDaGVhdCBNb2QiKSxoX2FsaWduPSdjZW50ZXInLHZfYWxpZ249J2NlbnRlcicpCiAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBzZWxmLmltYWdlID0gYmEuaW1hZ2V3aWRnZXQocGFyZW50PXNlbGYuX3Jvb3Rfd2lkZ2V0LAogICAgICAgICAgICAgICAgICAgICAgc2l6ZT0oNDAsNDApLGRyYXdfY29udHJvbGxlcj1zZWxmLmJ1dHRvbiwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPShwb3NpdGlvblswXSsxNSxwb3NpdGlvblsxXSszMCksCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlPWJhLmdldHRleHR1cmUoJ3NldHRpbmdzSWNvbicpKQogICAgICAgICAgICAgICAgICAgICAgCiAgICBkZWYgX2NoZWF0bWVudShzZWxmKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzZWxmLnNlc3Npb24sTWFpbk1lbnVTZXNzaW9uKToKICAgICAgICAgICAgYmEuY29udGFpbmVyd2lkZ2V0KGVkaXQ9c2VsZi5fcm9vdF93aWRnZXQsdHJhbnNpdGlvbj0nb3V0X2xlZnQnKQogICAgICAgICAgICBDaGVhdFdpbmRvdygpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYmEucGxheXNvdW5kKGJhLmdldHNvdW5kKCdlcnJvcicpKQogICAgICAgICAgICBiYS5zY3JlZW5tZXNzYWdlKGdldGxhbmd1YWdlKCdGb3JiaWRkZW4gTWVudScpLCgxLDAsMCkpCgpjbGFzcyBOZXdHYXRoZXJXaW5kb3coR2F0aGVyV2luZG93KToKICAgIGRlZiBfX2RlbF9fKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgX2JhLnNldF9wYXJ0eV9pY29uX2Fsd2F5c192aXNpYmxlKFRydWUpCgpjbGFzcyBOZXdQYXJ0eVdpbmRvdyhQYXJ0eVdpbmRvdyk6CiAgICBkZWYgX3NlbmRfY2hhdF9tZXNzYWdlKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc2VsZi50ZXh0ID0gYmEudGV4dHdpZGdldChxdWVyeT1zZWxmLl90ZXh0X2ZpZWxkKQogICAgICAgIHN1cGVyKCkuX3NlbmRfY2hhdF9tZXNzYWdlKCkKICAgICAgICB0cnk6IENoZWF0c0NvbW1hbmQoKS5oYW5kbGVtZXNzYWdlKHNlbGYudGV4dCkKICAgICAgICBleGNlcHQ6IHBhc3MKClNwYXouY2hlYXRfc3VwZXJfaW5pdCA9IFNwYXouX19pbml0X18KZGVmIGNoZWF0X3NwYXpfaW5pdChzZWxmLCphcmdzLCAqKmt3YXJncyk6CiAgICBzZWxmLmNoZWF0X3N1cGVyX2luaXQoKmFyZ3MsICoqa3dhcmdzKQogICAgc2VsZi5mcmVlemVfcHVuY2ggPSBGYWxzZQoKU3Bhei5jaGVhdF9zdXBlcl9oYW5kbGUgPSBTcGF6LmhhbmRsZW1lc3NhZ2UKZGVmIG5ld19oYW5kbGVtZXNzYWdlKHNlbGYsIG1zZyk6CiAgICBzZWxmLmNoZWF0X3N1cGVyX2hhbmRsZShtc2cpCiAgICBpZiBpc2luc3RhbmNlKG1zZywgYmEuSGl0TWVzc2FnZSk6CiAgICAgICAgaWYgbXNnLmhpdF90eXBlID09ICdwdW5jaCc6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIG1zZy5nZXRfc291cmNlX3BsYXllcihiYS5QbGF5ZXIpLmFjdG9yLmZyZWV6ZV9wdW5jaDoKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3IgPSAoMCwxLDQpCiAgICAgICAgICAgICAgICAgICAgYmEucGxheXNvdW5kKGJhLmdldHNvdW5kKCdmcmVlemUnKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlbWVzc2FnZShiYS5GcmVlemVNZXNzYWdlKCkpCiAgICAgICAgICAgIGV4Y2VwdDogcGFzcwoKY2xhc3MgQ2hlYXRXaW5kb3coUG9wdXBXaW5kb3cpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRyYW5zaXRpb249ICdpbl9yaWdodCcpOgogICAgICAgIGNvbHVtbnMgPSAyCiAgICAgICAgc2VsZi5fd2lkdGggPSB3aWR0aCA9IDgwMAogICAgICAgIHNlbGYuX2hlaWdodCA9IGhlaWdodCA9IDUwMAogICAgICAgIHNlbGYuX3N1Yl9oZWlnaHQgPSAyMDAKICAgICAgICBzZWxmLl9zY3JvbGxfd2lkdGggPSBzZWxmLl93aWR0aCowLjkwCiAgICAgICAgc2VsZi5fc2Nyb2xsX2hlaWdodCA9IHNlbGYuX2hlaWdodCAtIDE4MAogICAgICAgIHNlbGYuX3N1Yl93aWR0aCA9IHNlbGYuX3Njcm9sbF93aWR0aCowLjk1OwogICAgICAgIHNlbGYucm9zdGVyID0gX2JhLmdldF9nYW1lX3Jvc3RlcigpCiAgICAgICAgc2VsZi50YWJfYnV0dG9ucyA9IHt9CiAgICAgICAgc2VsZi5weXNfZGF0YSA9IFtdCgogICAgICAgIHNlbGYudGFiZGVmcyA9IHsiQWxsIFBsYXllcnMiOiBbJ3VzZXJzQnV0dG9uJywoMSwxLDEpXSwKICAgICAgICAgICAgICAgICAgICAgICAgIkluZm8iOiBbJ2ZpbGUnLCgxLDEsMSldLAogICAgICAgICAgICAgICAgICAgICAgICAiQ29tbWFuZHMiOiBbJ2ZvbGRlcicsKDEsMSwwLjUpXSwKICAgICAgICAgICAgICAgICAgICAgICAgIkFib3V0IjogWydoZWFydCcsKDEuNSwwLjMsMC4zKV19CiAgICAgICAgCiAgICAgICAgc2VsZi5saXN0ZGVmID0gbGlzdChzZWxmLnRhYmRlZnMpCiAgICAgICAgCiAgICAgICAgc2VsZi5jb3VudCA9IGxlbihzZWxmLnRhYmRlZnMpIC0gMQoKICAgICAgICBzZWxmLl9jdXJyZW50X3RhYiA9IEdMT0JBTFsnVGFiJ10KCiAgICAgICAgYXBwID0gYmEuYXBwLnVpCiAgICAgICAgdWlzY2FsZSA9IGFwcC51aXNjYWxlCgogICAgICAgIHNlbGYuX3Jvb3Rfd2lkZ2V0ID0gYmEuY29udGFpbmVyd2lkZ2V0KHNpemU9KHdpZHRoKzkwLGhlaWdodCs4MCksdHJhbnNpdGlvbj10cmFuc2l0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0xLjUgaWYgdWlzY2FsZSBpcyBiYS5VSVNjYWxlLlNNQUxMIGVsc2UgMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja19vZmZzZXQ9KDAsLTMwKSBpZiB1aXNjYWxlIGlzIGJhLlVJU2NhbGUuU01BTEwgZWxzZSAgKDAsMCkpCiAgICAgICAgCiAgICAgICAgc2VsZi5fYmFja0J1dHRvbiA9IGIgPSBiYS5idXR0b253aWRnZXQocGFyZW50PXNlbGYuX3Jvb3Rfd2lkZ2V0LGF1dG9zZWxlY3Q9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj0oNjAsc2VsZi5faGVpZ2h0LTE1KSxzaXplPSgxMzAsNjApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOCx0ZXh0X3NjYWxlPTEuMixsYWJlbD1iYS5Mc3RyKHJlc291cmNlPSdiYWNrVGV4dCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbl90eXBlPSdiYWNrJyxvbl9hY3RpdmF0ZV9jYWxsPWJhLkNhbGwoc2VsZi5fYmFjaykpCiAgICAgICAgYmEuYnV0dG9ud2lkZ2V0KGVkaXQ9c2VsZi5fYmFja0J1dHRvbiwgYnV0dG9uX3R5cGU9J2JhY2tTbWFsbCcsc2l6ZT0oNjAsIDYwKSxsYWJlbD1iYS5jaGFyc3RyKGJhLlNwZWNpYWxDaGFyLkJBQ0spKQoKICAgICAgICBiYS5jb250YWluZXJ3aWRnZXQoZWRpdD1zZWxmLl9yb290X3dpZGdldCxjYW5jZWxfYnV0dG9uPWIpCiAgICAgICAgc2VsZi50aXRsZXRleHQgPSBiYS50ZXh0d2lkZ2V0KHBhcmVudD1zZWxmLl9yb290X3dpZGdldCxwb3NpdGlvbj0oMCwgaGVpZ2h0LTE1KSxzaXplPSh3aWR0aCw1MCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgaF9hbGlnbj0iY2VudGVyIixjb2xvcj1iYS5hcHAudWkudGl0bGVfY29sb3Isdl9hbGlnbj0iY2VudGVyIixtYXh3aWR0aD13aWR0aCoxLjMpCgogICAgICAgIGluZGV4ID0gMAogICAgICAgIGZvciB0YWIgaW4gcmFuZ2Uoc2VsZi5jb3VudCk6CiAgICAgICAgICAgIGZvciB0YWIyIGluIHJhbmdlKGNvbHVtbnMpOgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0YWcgPSBzZWxmLmxpc3RkZWZbaW5kZXhdCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gKDYyMCsodGFiMioxMjApLHNlbGYuX2hlaWdodC01MCoyLjUtKHRhYioxMjApKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiB0YWcgIT0gJ0Fib3V0JzoKICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gZ2V0bGFuZ3VhZ2UodGFnKQogICAgICAgICAgICAgICAgZWxzZTogdGV4dCA9IGJhLkxzdHIocmVzb3VyY2U9J2dhdGhlcldpbmRvdy5hYm91dFRleHQnKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZWxmLnRhYl9idXR0b25zW3RhZ10gPSBiYS5idXR0b253aWRnZXQocGFyZW50PXNlbGYuX3Jvb3Rfd2lkZ2V0LGF1dG9zZWxlY3Q9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPXBvc2l0aW9uLHNpemU9KDExMCwxMTApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MSxsYWJlbD0nJyxlbmFibGVfc291bmQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25fdHlwZT0nc3F1YXJlJyxvbl9hY3RpdmF0ZV9jYWxsPWJhLkNhbGwoc2VsZi5fc2V0X3RhYix0YWcsc291bmQ9VHJ1ZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc2VsZi50ZXh0ID0gYmEudGV4dHdpZGdldChwYXJlbnQ9c2VsZi5fcm9vdF93aWRnZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj0ocG9zaXRpb25bMF0rNTUscG9zaXRpb25bMV0rMzApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT0oMCwgMCksc2NhbGU9MSxjb2xvcj1iYS5hcHAudWkudGl0bGVfY29sb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcmF3X2NvbnRyb2xsZXI9c2VsZi50YWJfYnV0dG9uc1t0YWddLG1heHdpZHRoPTEwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ9dGV4dCxoX2FsaWduPSdjZW50ZXInLHZfYWxpZ249J2NlbnRlcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc2VsZi5pbWFnZSA9IGJhLmltYWdld2lkZ2V0KHBhcmVudD1zZWxmLl9yb290X3dpZGdldCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplPSg2MCw2MCksY29sb3I9c2VsZi50YWJkZWZzW3RhZ11bMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhd19jb250cm9sbGVyPXNlbGYudGFiX2J1dHRvbnNbdGFnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj0ocG9zaXRpb25bMF0rMjUscG9zaXRpb25bMV0rNDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHR1cmU9YmEuZ2V0dGV4dHVyZShzZWxmLnRhYmRlZnNbdGFnXVswXSkpCgogICAgICAgICAgICAgICAgaW5kZXggKz0gMQogICAgICAgIAogICAgICAgICAgICAgICAgaWYgaW5kZXggPiBzZWxmLmNvdW50OgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAKICAgICAgICAgICAgaWYgaW5kZXggPiBzZWxmLmNvdW50OgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgIAogICAgICAgIHNlbGYuX3Njcm9sbHdpZGdldCA9IGJhLnNjcm9sbHdpZGdldChwYXJlbnQ9c2VsZi5fcm9vdF93aWRnZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPShzZWxmLl93aWR0aCowLjA4LDUxKjEuOCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9KHNlbGYuX3N1Yl93aWR0aCAtMTQwLHNlbGYuX3Njcm9sbF9oZWlnaHQgKzYwKjEuMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbl9sb29wc190b19wYXJlbnQ9VHJ1ZSkKICAgICAgICBzZWxmLl90YWJfY29udGFpbmVyID0gTm9uZQogICAgICAgIHNlbGYuX3NldF90YWIoc2VsZi5fY3VycmVudF90YWIpCgogICAgZGVmIF9zZXRfdGFiKHNlbGYsIHRhYiwgc291bmQ6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgc2VsZi5zb3VuZCA9IHNvdW5kCiAgICAgICAgR0xPQkFMWydUYWInXSA9IHRhYgogICAgICAgIAogICAgICAgIGlmIHRhYiAhPSAiQWJvdXQiOgogICAgICAgICAgICB0ZXh0ID0gZ2V0bGFuZ3VhZ2UodGFiKQogICAgICAgIGVsc2U6IHRleHQgPSBiYS5Mc3RyKHJlc291cmNlPSdnYXRoZXJXaW5kb3cuYWJvdXRUZXh0JykKICAgICAgICAKICAgICAgICBiYS50ZXh0d2lkZ2V0KGVkaXQ9c2VsZi50aXRsZXRleHQsdGV4dD10ZXh0KQogICAgICAgIAogICAgICAgIGlmIHNlbGYuX3RhYl9jb250YWluZXIgaXMgbm90IE5vbmUgYW5kIHNlbGYuX3RhYl9jb250YWluZXIuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYuX3RhYl9jb250YWluZXIuZGVsZXRlKCkKCiAgICAgICAgaWYgc2VsZi5zb3VuZDoKICAgICAgICAgICAgYmEucGxheXNvdW5kKGJhLmdldHNvdW5kKCdjbGljazAxJykpCgogICAgICAgIGlmIHRhYiA9PSAnQWxsIFBsYXllcnMnOgogICAgICAgICAgICBzdWJfaGVpZ2h0ID0gbGVuKHNlbGYucm9zdGVyKSAqIDUzCiAgICAgICAgICAgIHYgPSBzdWJfaGVpZ2h0IC0gNTUKICAgICAgICAgICAgcG9zID0gMAogICAgICAgICAgICB3aWR0aCA9IDMwMAoKICAgICAgICAgICAgc2VsZi5fdGFiX2NvbnRhaW5lciA9IGMgPSBiYS5jb250YWluZXJ3aWRnZXQocGFyZW50PXNlbGYuX3Njcm9sbHdpZGdldCwKICAgICAgICAgICAgICAgIHNpemU9KHNlbGYuX3N1Yl93aWR0aCxzdWJfaGVpZ2h0KSwKICAgICAgICAgICAgICAgIGJhY2tncm91bmQ9RmFsc2Usc2VsZWN0aW9uX2xvb3BzX3RvX3BhcmVudD1UcnVlKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgc2VsZi5yb3N0ZXIgIT0gW106CiAgICAgICAgICAgICAgICBmb3IgcGxheWVycyBpbiBzZWxmLnJvc3RlcjoKICAgICAgICAgICAgICAgICAgICBpZiBwbGF5ZXJzWydwbGF5ZXJzJ10gIT0gW106CiAgICAgICAgICAgICAgICAgICAgICAgIGogPSBwbGF5ZXJzWydwbGF5ZXJzJ11bMF1bJ25hbWVfZnVsbCddCiAgICAgICAgICAgICAgICAgICAgICAgIHNnID0gcGxheWVyc1snZGlzcGxheV9zdHJpbmcnXQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnB5c19kYXRhLmFwcGVuZChzZykKICAgICAgICAgICAgICAgICAgICBlbHNlOiBjb250aW51ZQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIHNnID09IGo6IHRleHQgPSAoZid7an0nKQogICAgICAgICAgICAgICAgICAgIGVsc2U6IHRleHQgPSAoZid7an0gLS0tLS0+IHtzZ30nKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHQgPSBiYS50ZXh0d2lkZ2V0KHBhcmVudD1jLHBvc2l0aW9uPSgxMTAsIHYtMjAtcG9zKSxzaXplPSh3aWR0aCw1MCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MSxjb2xvcj0oMS4xLDAuOCwwKSxoX2FsaWduPSJjZW50ZXIiLHZfYWxpZ249ImNlbnRlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dD10ZXh0LG1heHdpZHRoPXdpZHRoKjMwKQogICAgICAgICAgICAgICAgICAgIHBvcyArPSA2MAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdCA9IGJhLnRleHR3aWRnZXQocGFyZW50PWMscG9zaXRpb249KDExMCwgdi0xMDApLHNpemU9KHdpZHRoLDUwKSwKICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTEsY29sb3I9KDEuMSwwLjIsMC4yKSxoX2FsaWduPSJjZW50ZXIiLHZfYWxpZ249ImNlbnRlciIsCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0PWJhLkxzdHIocmVzb3VyY2U9J3BhcnR5V2luZG93LmVtcHR5VGV4dCcpLG1heHdpZHRoPXdpZHRoKjMwKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICBlbGlmIHRhYiA9PSAnSW5mbyc6CiAgICAgICAgICAgIHN1Yl9oZWlnaHQgPSAzMDAKICAgICAgICAgICAgdiA9IHN1Yl9oZWlnaHQgLSA1NQogICAgICAgICAgICB3aWR0aCA9IDMwMAogICAgICAgICAgICB4cHMgPSAwCiAgICAgICAgICAgIAogICAgICAgICAgICBzZWxmLl90YWJfY29udGFpbmVyID0gYyA9IGJhLmNvbnRhaW5lcndpZGdldChwYXJlbnQ9c2VsZi5fc2Nyb2xsd2lkZ2V0LAogICAgICAgICAgICAgICAgc2l6ZT0oc2VsZi5fc3ViX3dpZHRoLHN1Yl9oZWlnaHQpLAogICAgICAgICAgICAgICAgYmFja2dyb3VuZD1GYWxzZSxzZWxlY3Rpb25fbG9vcHNfdG9fcGFyZW50PVRydWUpCgogICAgICAgICAgICB0ID0gYmEudGV4dHdpZGdldChwYXJlbnQ9Yyxwb3NpdGlvbj0oLTkwLCB2LTQwKSxzaXplPSh3aWR0aCw1MCksCiAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0zLGNvbG9yPSgxLDEsMSksaF9hbGlnbj0iY2VudGVyIix2X2FsaWduPSJjZW50ZXIiLAogICAgICAgICAgICAgICAgICAgICAgdGV4dD0oJy8nKSxtYXh3aWR0aD13aWR0aCozMCkKICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICB0ID0gYmEudGV4dHdpZGdldChwYXJlbnQ9Yyxwb3NpdGlvbj0oLTkwLCB2LTE3MCksc2l6ZT0od2lkdGgsNTApLAogICAgICAgICAgICAgICAgICAgICAgc2NhbGU9Myxjb2xvcj0oMSwxLDEpLGhfYWxpZ249ImNlbnRlciIsdl9hbGlnbj0iY2VudGVyIiwKICAgICAgICAgICAgICAgICAgICAgIHRleHQ9KCc/JyksbWF4d2lkdGg9d2lkdGgqMzApCiAgIAogICAgICAgICAgICB0ID0gYmEudGV4dHdpZGdldChwYXJlbnQ9Yyxwb3NpdGlvbj0oLTkwLCB2LTMwMCksc2l6ZT0od2lkdGgsNTApLAogICAgICAgICAgICAgICAgICAgICAgc2NhbGU9Myxjb2xvcj0oMSwxLDEpLGhfYWxpZ249ImNlbnRlciIsdl9hbGlnbj0iY2VudGVyIiwKICAgICAgICAgICAgICAgICAgICAgIHRleHQ9KCchJyksbWF4d2lkdGg9d2lkdGgqMzApCiAgIAogICAgICAgICAgICBzeW1ib2wgPSBbIlN5bWJvbCAvIiwiU3ltYm9sID8iLCJTeW1ib2wgISJdCiAgICAgICAgICAgICAgIAogICAgICAgICAgICBwb3MgPSAwCiAgICAgICAgICAgIGZvciBpdHh0IGluIHN5bWJvbDoKICAgICAgICAgICAgICAgIHQgPSBiYS50ZXh0d2lkZ2V0KHBhcmVudD1jLHBvc2l0aW9uPSgxMDAsIHYtMzAtcG9zKSxzaXplPSh3aWR0aCw1MCksCiAgICAgICAgICAgICAgICAgICAgICBjb2xvcj1iYS5hcHAudWkudGl0bGVfY29sb3IsaF9hbGlnbj0iY2VudGVyIix2X2FsaWduPSJjZW50ZXIiLAogICAgICAgICAgICAgICAgICAgICAgdGV4dD1nZXRsYW5ndWFnZShpdHh0KSxtYXh3aWR0aD13aWR0aCozMCkKICAgICAgICAgICAgICAgIHBvcyArPSAxNDAKICAgCiAgICAgICAgZWxpZiB0YWIgPT0gJ0NvbW1hbmRzJzoKICAgICAgICAgICAgY29tbWFuZCA9IENoZWF0c0NvbW1hbmQoKS5jb21tYW5kcygpCiAgICAgICAgICAgIGNvdW50ID0gbGVuKGNvbW1hbmQpCiAgICAgICAgICAgIGNvbHVtcyA9IDQKICAgICAgICAgICAgc3ViX2hlaWdodCA9IChjb3VudC80Kjg5LjYrY291bnQvY291bnQqNTApKjAuNzEKICAgICAgICAgICAgdiA9IHN1Yl9oZWlnaHQgLSA1NQogICAgICAgICAgICB3aWR0aCA9IDMwMAogICAgICAgICAgICAKICAgICAgICAgICAgc2VsZi5fdGFiX2NvbnRhaW5lciA9IGMgPSBiYS5jb250YWluZXJ3aWRnZXQocGFyZW50PXNlbGYuX3Njcm9sbHdpZGdldCwKICAgICAgICAgICAgICAgIHNpemU9KHNlbGYuX3N1Yl93aWR0aCxzdWJfaGVpZ2h0KSwKICAgICAgICAgICAgICAgIGJhY2tncm91bmQ9RmFsc2Usc2VsZWN0aW9uX2xvb3BzX3RvX3BhcmVudD1UcnVlKQoKICAgICAgICAgICAgaW5kZXggPSAwCiAgICAgICAgICAgIGZvciB5IGluIHJhbmdlKGNvdW50KToKICAgICAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKGNvbHVtcyk6CiAgICAgICAgICAgICAgICAgICAgaWYgIi8iIGluIGNvbW1hbmRbaW5kZXhdOgogICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9ICgwLjgsMS4xLDApCiAgICAgICAgICAgICAgICAgICAgZWxpZiAiISIgaW4gY29tbWFuZFtpbmRleF06CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gKDAsMSwwLjUpCiAgICAgICAgICAgICAgICAgICAgZWxpZiAiPyIgaW4gY29tbWFuZFtpbmRleF06CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gKDAuOCwwLDEuMSkKICAgICAgICAgICAgICAgICAgICBlbHNlOiBjb2xvciA9ICgxLDEsMSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9ICgtNjArKHgqMTE1KSwgdi01LSh5KjkwKSowLjgwKQogICAgICAgICAgICAgICAgICAgIHQgPSBiYS50ZXh0d2lkZ2V0KHBhcmVudD1jLHBvc2l0aW9uPXBvc2l0aW9uLHNpemU9KHdpZHRoLDUwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcj1jb2xvcixoX2FsaWduPSJjZW50ZXIiLHZfYWxpZ249ImNlbnRlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dD1jb21tYW5kW2luZGV4XSxtYXh3aWR0aD13aWR0aCozMCkKICAgICAgICAgICAgICAgICAgICBpbmRleCArPSAxCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgaW5kZXggPT0gY291bnQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgaW5kZXggPT0gY291bnQ6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3ViX2hlaWdodCA9IDAKICAgICAgICAgICAgdiA9IHN1Yl9oZWlnaHQgLSA1NQogICAgICAgICAgICB3aWR0aCA9IDMwMAogICAgICAgICAgICAKICAgICAgICAgICAgc2VsZi5fdGFiX2NvbnRhaW5lciA9IGMgPSBiYS5jb250YWluZXJ3aWRnZXQocGFyZW50PXNlbGYuX3Njcm9sbHdpZGdldCwKICAgICAgICAgICAgICAgIHNpemU9KHNlbGYuX3N1Yl93aWR0aCxzdWJfaGVpZ2h0KSwKICAgICAgICAgICAgICAgIGJhY2tncm91bmQ9RmFsc2Usc2VsZWN0aW9uX2xvb3BzX3RvX3BhcmVudD1UcnVlKQoKICAgICAgICAgICAgdCA9IGJhLnRleHR3aWRnZXQocGFyZW50PWMscG9zaXRpb249KDExMCwgdi0yMCksc2l6ZT0od2lkdGgsNTApLAogICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MS40LGNvbG9yPSgwLjIsMS4yLDAuMiksaF9hbGlnbj0iY2VudGVyIix2X2FsaWduPSJjZW50ZXIiLAogICAgICAgICAgICAgICAgICAgICAgdGV4dD0iQ2hlYXQgTW9kIHYxLjAiLG1heHdpZHRoPXdpZHRoKjMwKQoKICAgICAgICAgICAgdCA9IGJhLnRleHR3aWRnZXQocGFyZW50PWMscG9zaXRpb249KDExMCwgdi05MCksc2l6ZT0od2lkdGgsNTApLAogICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MSxjb2xvcj0oMS4zLDAuNSwxLjApLGhfYWxpZ249ImNlbnRlciIsdl9hbGlnbj0iY2VudGVyIiwKICAgICAgICAgICAgICAgICAgICAgIHRleHQ9Z2V0bGFuZ3VhZ2UoJ0NyZWF0b3InKSxtYXh3aWR0aD13aWR0aCozMCkKCiAgICAgICAgICAgIHQgPSBiYS50ZXh0d2lkZ2V0KHBhcmVudD1jLHBvc2l0aW9uPSgxMTAsIHYtMjIwKSxzaXplPSh3aWR0aCw1MCksCiAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0xLGNvbG9yPSgxLjAsMS4yLDAuMyksaF9hbGlnbj0iY2VudGVyIix2X2FsaWduPSJjZW50ZXIiLAogICAgICAgICAgICAgICAgICAgICAgdGV4dD1nZXRsYW5ndWFnZSgnTW9kIEluZm8nKSxtYXh3aWR0aD13aWR0aCozMCkKCiAgICAgICAgZm9yIHNlbGVjdF90YWIsYnV0dG9uX3RhYiBpbiBzZWxmLnRhYl9idXR0b25zLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHNlbGVjdF90YWIgPT0gdGFiOgogICAgICAgICAgICAgICAgYmEuYnV0dG9ud2lkZ2V0KGVkaXQ9YnV0dG9uX3RhYixjb2xvcj0oMC41LDAuNCwxLjUpKQogICAgICAgICAgICBlbHNlOiBiYS5idXR0b253aWRnZXQoZWRpdD1idXR0b25fdGFiLGNvbG9yPSgwLjUyLDAuNDgsMC42MykpCgogICAgZGVmIF9iYWNrKHNlbGYpOgogICAgICAgIGJhLmNvbnRhaW5lcndpZGdldChlZGl0PXNlbGYuX3Jvb3Rfd2lkZ2V0LHRyYW5zaXRpb249J291dF9sZWZ0JykKICAgICAgICBOZXdBbGxTZXR0aW5nc1dpbmRvdygpCg==").decode('UTF-8'))

# ba_meta export plugin
class CheatMod(ba.Plugin):
    allsettings.AllSettingsWindow = NewAllSettingsWindow
    party.PartyWindow = NewPartyWindow
    gather.GatherWindow = NewGatherWindow
    playerspaz.PlayerSpaz = NewPlayerSpaz 
    Spaz.__init__ = cheat_spaz_init
    Spaz.handlemessage = new_handlemessage